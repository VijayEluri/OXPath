/**
 * 
 */
package uk.ac.ox.comlab.oxpath.placeRankDemo;

/**
 * Class for objects encoding Right Move queries 
 * @author AndrewJSel
 *
 */
public class RightMoveQuery implements SiteQuery {

	/**
	 * Basic Constuctor for Right Move Query
	 * @param iBeds number of beds 
	 * @param iMaxRent maximum rent
	 * @param isFurn is Furnished
	 * @param isLong is available longterm
	 */
	public RightMoveQuery(int iBeds, RightMoveRentPrice iMaxRent, boolean isFurn, boolean isLong) {
		this.beds = iBeds;
		this.maxRent = iMaxRent;
		this.isFurnished = isFurn;
		this.isLongterm = isLong;
	}
	
	/* (non-Javadoc)
	 * @see uk.ac.ox.comlab.oxpath.placeRankDemo.SiteQuery#getOXPath(java.lang.String)
	 */
	/**
	 * Method for returning OXPath expression for this object, given a specific postcode
	 * @param postcode post code for query
	 * @return OXPath expression from this object for the given postcode
	 */
	@Override
	public String getOXPath(String postcode) {
		StringBuilder sb = new StringBuilder();
		sb.append("path={<http://www.rightmove.co.uk>/}/descendant::field()[1]/{\"");
		sb.append(postcode);
		sb.append("\"}/following::input#rent/{click/}//select#minBedrooms/{\"");
		sb.append(this.beds);
		sb.append("\"/}//select#maxPrice/{\"");
		sb.append(this.maxRent.toString());
		sb.append("/}//input[@id='submit']/{click/}/(//a[.#='next']/{click/})*//ol#summaries/li");
		if (this.isFurnished||this.isLongterm) {
			sb.append("[descendant::a[.#='More details']/{click/}//div#propertydetails");
			if (this.isFurnished) sb.append("[.#='Furnished']");
			if (this.isLongterm) sb.append("[not(.#='Short term')]");
			sb.append("]:<property=(.)>;");
		}
		return sb.toString();
	}

	//instance fields
	/**
	 * Number of beds (private instance field)
	 */
	private int beds;
	/**
	 * Maximum Rent (private instance field)
	 */
	private RightMoveRentPrice maxRent;
	/**
	 * Is Furnished (private instance field)
	 */
	boolean isFurnished;
	/**
	 * Is Longterm (private instance field)
	 */
	boolean isLongterm;
	
}
